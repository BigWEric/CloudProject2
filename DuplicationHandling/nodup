import java.io.BufferedInputStream;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;

public class nodup {
	private static String input=new String("Tweets_Boston.txt");
	private static String output=new String("out.txt");
    private static FileWriter fw;
    private static BufferedInputStream fr;
    private static BufferedWriter bw;
    private static BufferedReader br;
	public static void main(String[] args)
	{
		ArrayList<String> temp=new ArrayList<String>();
		String temp_in=null;
		if(args.length!=0&&args[0]!=null&&args[1]!=null)
		{
			input=args[0];
			output=args[1];
		}
		File in=new File(input);
		File out=new File(output);
	
		try {
			fw=new FileWriter(out.getAbsoluteFile());
			bw=new BufferedWriter(fw);
			BufferedInputStream fr = new BufferedInputStream(new FileInputStream(in));
			br=new BufferedReader(new InputStreamReader(fr,"utf-8"),5*1024*1024);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			while((temp_in=br.readLine())!=null)
			{
				int pivot=temp_in.indexOf("\"id\":");
				String id=null;
				id=temp_in.substring(pivot, pivot+23);
				
				if(!temp.contains(id))
				{	
					temp.add(id);
					bw.append(temp_in);
					bw.append("\n");
				}
			}
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		System.out.println("All done!");
		try {
			bw.close();
			fw.close();
			br.close();
			fr.close();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		
	}
}
